var I=Object.defineProperty;var O=(o,t,i)=>t in o?I(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i;var l=(o,t,i)=>(O(o,typeof t!="symbol"?t+"":t,i),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function i(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function e(n){if(n.ep)return;n.ep=!0;const s=i(n);fetch(n.href,s)}})();const C=(o,t)=>({x:o??0,y:t??0}),z=(o,t,i,e,n,s,r,a)=>{let h=i<n,d=o>r,g=t>a,R=e<s;return!(h||d||g||R)};class p{constructor(t,i,e,n){l(this,"x1");l(this,"y1");l(this,"x2");l(this,"y2");this.x1=t,this.y1=i,this.x2=e,this.y2=n}containsPoint(t){return t.x>=this.x1&&t.x<=this.x2&&t.y>=this.y1&&t.y<=this.y2}intersectsWithRect(t){return z(this.x1,this.y1,this.x2,this.y2,t.x1,t.y1,t.x2,t.y2)}intersectsWithCircle(t,i,e){return A(this,t,i,e)}}const A=(o,t,i,e)=>{const{x1:n,y1:s,x2:r,y2:a}=o,h=C(n+(r-n)/2,s+(a-s)/2),d=r-n,g=a-s;var R=Math.abs(t-h.x),B=Math.abs(i-h.y);if(R>d/2+e||B>g/2+e)return!1;if(R<=d/2||B<=g/2)return!0;var x=R-d/2,L=B-g/2;return x*x+L*L<=e*e},W=(o,t,i,e,n)=>(e-o)*(e-o)+(n-t)*(n-t)<=i*i;class y{constructor(t){l(this,"boundary");l(this,"split");l(this,"topLeftQuad");l(this,"topRightQuad");l(this,"bottomLeftQuad");l(this,"bottomRightQuad");l(this,"boids");l(this,"capacity");this.boundary=t,this.split=!1,this.boids=[],this.capacity=1}splitIntoQuads(){const{x1:t,y1:i,x2:e,y2:n}=this.boundary,s=C(t+(e-t)/2,i+(n-i)/2),r=new y(new p(t,i,s.x,s.y));this.topLeftQuad=r;const a=new y(new p(s.x,i,e,s.y));this.topRightQuad=a;const h=new y(new p(t,s.y,s.x,n));this.bottomLeftQuad=h;const d=new y(new p(s.x,s.y,e,n));this.bottomRightQuad=d,this.split=!0}insertBoid(t){var i,e,n,s;this.boundary.containsPoint(t.position)&&(this.boids.length<this.capacity?this.boids.push(t):(this.split||this.splitIntoQuads(),(i=this.topLeftQuad)!=null&&i.boundary.containsPoint(t.position)?this.topLeftQuad.insertBoid(t):(e=this.topRightQuad)!=null&&e.boundary.containsPoint(t.position)?this.topRightQuad.insertBoid(t):(n=this.bottomLeftQuad)!=null&&n.boundary.containsPoint(t.position)?this.bottomLeftQuad.insertBoid(t):(s=this.bottomRightQuad)!=null&&s.boundary.containsPoint(t.position)&&this.bottomRightQuad.insertBoid(t)))}getNearbyBoidsRectangleRadius(t,i){const e=new p(t.position.x-i,t.position.y-i,t.position.x+i,t.position.y+i),n=[];if(this.boundary.intersectsWithRect(e)){for(const s of this.boids)e.containsPoint(s.position)&&n.push(s);this.split&&(n.push(...this.topLeftQuad.getNearbyBoidsRectangleRadius(t,i)),n.push(...this.topRightQuad.getNearbyBoidsRectangleRadius(t,i)),n.push(...this.bottomLeftQuad.getNearbyBoidsRectangleRadius(t,i)),n.push(...this.bottomRightQuad.getNearbyBoidsRectangleRadius(t,i)))}return n}getNearbyBoidsCircleRadius(t,i){const e=[];if(this.boundary.intersectsWithCircle(t.position.x,t.position.y,i)){for(const n of this.boids)W(t.position.x,t.position.y,i,n.position.x,n.position.y)&&e.push(n);this.split&&(e.push(...this.topLeftQuad.getNearbyBoidsCircleRadius(t,i)),e.push(...this.topRightQuad.getNearbyBoidsCircleRadius(t,i)),e.push(...this.bottomLeftQuad.getNearbyBoidsCircleRadius(t,i)),e.push(...this.bottomRightQuad.getNearbyBoidsCircleRadius(t,i)))}return e}}const P=(o,t)=>(o=Math.ceil(o),t=Math.floor(t),Math.floor(Math.random()*(t-o+1)+o)),c=(o,t)=>({x:o??0,y:t??0}),u=(o,t)=>c(o.x+t.x,o.y+t.y),m=(o,t)=>c(o.x-t.x,o.y-t.y),v=(o,t)=>c(o.x/t,o.y/t),N=o=>Math.sqrt(o.x**2+o.y**2),w=o=>{const t=N(o);return v(o,t)},Q=(o,t)=>c(o.x*t,o.y*t),q=o=>{let t=Math.random()*10-5,i=Math.random()*10-5;const e=Math.hypot(t,i);t/=e,i/=e;const n=c(t,i);return{position:c(P(0,o.canvas.width),P(0,o.canvas.height)),veloctiy:n,accelaration:c(),cohesion:c(),alignment:c(),seperation:c()}},E=(o,t,i)=>{let e=c();const n=t.getNearbyBoidsCircleRadius(o,i);let s=0;for(const r of n)r!=o&&(e=u(e,r.veloctiy),s++);if(s>0){e=v(e,s);let r=m(e,o.veloctiy);return r=w(r),r=Q(r,.02),r}return e},F=(o,t,i)=>{let e=c();const n=t.getNearbyBoidsCircleRadius(o,i);let s=0;for(const r of n)o!=r&&(e=u(e,r.position),s++);if(s>0){e=v(e,s);let r=m(e,o.position),a=m(r,o.veloctiy);return a=w(a),a=Q(a,.03),a}return e},X=(o,t,i)=>{let e=c();const n=t.getNearbyBoidsCircleRadius(o,i);let s=0;for(const r of n){const a=m(o.position,r.position),h=N(a);if(o!=r){const d=v(a,h);e=u(e,d),s++}}if(s>0){e=v(e,s);let r=m(e,o.veloctiy);return r=w(r),r=Q(r,.08),r}return e},Y=(o,t)=>{const i=E(o,t,50);o.alignment=i;const e=F(o,t,30);o.cohesion=e;const n=X(o,t,30);o.seperation=n},H=(o,t,i)=>{o.accelaration=c(),o.accelaration=u(o.accelaration,o.alignment),o.accelaration=u(o.accelaration,o.cohesion),o.accelaration=u(o.accelaration,o.seperation),o.veloctiy=u(o.veloctiy,o.accelaration),o.veloctiy=w(o.veloctiy),o.position=u(o.position,o.veloctiy),o.position.x>t?o.position.x=0:o.position.x<0&&(o.position.x=t),o.position.y>i?o.position.y=0:o.position.y<0&&(o.position.y=i)},K=(o,t,i,e)=>{let n=Math.atan2(e-t,i-o);return n<0&&(n+=2*Math.PI),n},$=(o,t)=>{o.save(),o.beginPath(),o.fillStyle="rgb(100, 100, 100, 1)",o.strokeStyle="rgb(100, 100, 100, 1)";const i=6;o.translate(t.position.x,t.position.y),o.rotate(-Math.PI/2),o.rotate(K(t.position.x,t.position.y,t.position.x+t.veloctiy.x*5,t.position.y+t.veloctiy.y*5)),o.translate(-t.position.x,-t.position.y),o.moveTo(t.position.x-i,t.position.y-i),o.lineTo(t.position.x,t.position.y+i),o.lineTo(t.position.x+i,t.position.y-i),o.closePath(),o.stroke(),o.restore()},j=(o,t)=>{H(o,t.canvas.width,t.canvas.height)},D=(o,t)=>{const i=new y(new p(0,0,o.canvas.width,o.canvas.height));for(const e of t)i.insertBoid(e);o.clearRect(0,0,o.canvas.width,o.canvas.height);for(const e of t)Y(e,i);for(const e of t)j(e,o),$(o,e)},M=document.createElement("canvas");document.body.appendChild(M);const f=M.getContext("2d");f.canvas.width=window.innerWidth;f.canvas.height=window.innerHeight;const V=[],G=250;for(let o=0;o<G;o++)V.push(q(f));const S=()=>{D(f,V),requestAnimationFrame(S)};requestAnimationFrame(S);window.addEventListener("resize",()=>{console.log("resize"),f.canvas.width=window.innerWidth,f.canvas.height=window.innerHeight});
